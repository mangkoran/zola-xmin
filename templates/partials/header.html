<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      {% if page.title %} {{ page.title }}
      {% elif section.title %} {{ section.title }}
      {% elif taxonomy.name %} {{ taxonomy.name }}
      {% endif %} | {{ config.title }}
    </title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono&family=Rubik:ital,wght@0,300..900;1,300..900&family=STIX+Two+Text:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
    <link rel="stylesheet" href="{{ get_url(path="css/style.css") }}" />
    <link rel="stylesheet" href="{{ get_url(path="css/fonts.css") }}" />
    <script src="https://cdn.jsdelivr.net/gh/gnat/css-scope-inline@main/script.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/gnat/surreal@main/surreal.js"></script>
    {% include "partials/head_custom.html" %}
  </head>

  <body>
    <nav>
      <ul class="menu">
        <style>
          me { padding: 0; text-align: center; }
          me a, me button {
            text-decoration: none;
            background: var(--md-sys-color-surface-container-high);
            padding: 5px;
            border:none;
            border-radius: 5px;
            color: var(--md-sys-color-on-surface);
            line-height: 1.0;
          }
          me a, me li { display: inline-block; }
        </style>
        {% for page in config.extra.menus.main %}
        <li><a href="{{ get_url(path=page.url, trailing_slash=true) }}">{{ page.name }}</a></li>
        {% endfor %}
        <li>
          <button type="button">Theme
            <script>
              // https://docs.astro.build/en/tutorial/6-islands/2/
              const theme = (() => {
                if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                  return localStorage.getItem('theme');
                }
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                  return 'dark';
                }
                  return 'light';
              })();

              if (theme === 'light') {
                document.documentElement.classList.remove('dark');
              } else {
                document.documentElement.classList.add('dark');
              }

              window.localStorage.setItem('theme', theme);

              me().on("click", () => {
                const element = document.documentElement;
                element.classList.toggle("dark");

                const isDark = element.classList.contains("dark");
                localStorage.setItem("theme", isDark ? "dark" : "light");
              })
            </script>
          </button>
        </li>
      </ul>
      <hr/>
    </nav>
